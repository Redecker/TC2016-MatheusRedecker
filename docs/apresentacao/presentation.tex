\documentclass{beamer}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage{colortbl}
\usepackage{epstopdf}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{listings}
\usepackage{letltxmacro}
\usepackage{algorithm, algpseudocode}

\renewcommand{\lstlistingname}{Listing}
\interfootnotelinepenalty=10000
\usepackage{listings}
\usepackage{algpseudocode}
\lstset{
    %numbers=left,
    numberblanklines=false,
    captionpos=b,
    breaklines=true,
    frameshape={RYRYN}{ny}{yn}{RYRYN},
    literate={~} {$\sim$}{1}
}
\usepackage{pgfpages}
%\setbeameroption{show notes on second screen=right}

\usetheme{Madrid}
\usecolortheme{seagull}
\title[\fontsize{0.08cm}{1em}\selectfont AHTN para Jogos em Tempo Real]{Adversarial Hierarchical-Task Network para Jogos em Tempo Real}
\author[Matheus de Souza Redecker]{Matheus de Souza Redecker
\\{\footnotesize Orientador: Prof. Dr. Felipe R. Meneguzzi}
}
\institute[PUCRS]{Pontificia Universidade Catolia do Rio Grande do Sul
\medskip\\
\url{matheus.redecker@acad.pucrs.br}
}
\date{\today}
\begin{document}

%---------------------------------------------------------------------------------

    \begin{frame}
        \titlepage
    \end{frame}

%---------------------------------------------------------------------------------
%	{
%	\setbeamercolor{background canvas}{bg=lightgray}
%    \begin{frame}{Outline}
%       	\begin{itemize}
%       		\item \textbf{Introduction and Motivation}
%       		\item \textbf{Background}
%       		\item \textbf{Extracting Recognition Information From Domain Analysis}
%			\item \textbf{Landmark-based Plan Recognition}
%			\item \textbf{Planning-based Plan Abandonment Detection}
%			\item \textbf{Experiments and Evaluation}
%			\item \textbf{Related Work}
%			\item \textbf{Conclusion}			
%        \end{itemize}
%    \end{frame}
%	}
%---------------------------------------------------------------------------------

%Motivação

\begin{frame}{Motivação}
	\begin{itemize}
	    \item Jogos em Inteligência Artificial
	    \item Algoritmo de Adversarial Hierarchical-Task Network
	    \item MicroRTS
    \end{itemize}
    \note{xxxx}
\end{frame}
%A IA em jogos faz com que os computadores sejam capazes de jogar jogos como xadrez e jogo da velha sem intervenção humana.
%As técnicas são usadas para ter uma melhor interação com o usuario, e ele não perceber que está jogando contra uma maquina
%Mas as vezes as técnicas utilizadas nos jogos não são interamente de IA, pois elas podem utilizam conhecimentos proveniente do controle do jogo para tomar suas decisões.
%Outro fator é o tempo de tomada das ações, muitas vezes não há um tempo grande para decidir qual o proximo passo a ser tomado, com isso técnicas que tentam explorar todas as possibilidaes de um jogo se tornam ineficazes.
% O Xadrez por exemplo tem 10^40 estados possíveis do jogo
% é preciso algoritmos eficientes para gerar uma ação de forma rapida.

%O algoritmo de AHTN foi proposto para mitigar as limitações computacionais de abordagens tradicionais de raciocionio em jogos.
%O algoritmo foi proposto por Santiago Ortanon  e combina técnicas de planejamento e busca adversária.

%O MicroRTS é uma simplificação de jogos como Stracraft e Age of Empires.
%Ele é um jogo RTS e foi desenvolvido em Java, para facilitar a codificação de técnicas de IA e servir de prova de conceito para as técnicas criadas

% O intuito deste trabalho é explorar eficientemente o espaço de ações disponíveis no MicroRTS utilizando conhecimento de domínio, a fim de definir qual a próxima ação que deve ser executada.

%Background
{
	\setbeamercolor{background canvas}{bg=lightgray}
	\begin{frame}{Background}
		\vspace{5mm}
		\begin{itemize}
			\item \textbf{Busca}
			\item \textbf{Minimax}
			\item \textbf{Planejamento}       		
			\item \textbf{Planejamento Hierárquico}
		\end{itemize}
	\end{frame}
}
%BUSCA
\begin{frame}{Busca adversária}
	\begin{itemize}
		\item Árvore das jogadas (\textit{game tree})
		\item Estado terminal
		\item Função de avaliação
	\end{itemize}
	
	\begin{figure}[here]
		\includegraphics[width=0.45\linewidth]{fig/jogodavelha.pdf}	
	\end{figure}
\end{frame}
%Técnicas de busca tem como objetivo encontrar uma sequência de passos para que um agente alcance um determinado objetivo.
%Já a busca adversária é utiliza em ambientes competitivas que possuam mais de um agente 
%As técnicas utilizam a arvore das jogadas para percorrer o espaço de estados dos jogos
%Por exemplo, no jogo da velha, cada possibilidade de jogada deve ser percorrida para que o algoritmo possa determinar qual a melhor jogada
%O estado terminal indica quando o jogo chegou ao fim, e nele deve ser possivel obter um valor através da função de avaliação, para que seja possivel ver o quão bom foi a sequencia de ações para chegar a esse estado

%Minimax
\begin{frame}{Minimax}
	\vspace{-3mm}
	\begin{figure}[here]
		\includegraphics[width=0.8\linewidth]{fig/gametree.pdf}	
	\end{figure}	
\end{frame}
%O algoritmo de Minimax é um algoritmo de busca adversária que tem como objetivo determinar qual a melhor jogada para o estado atual.
%Este método considera dois agentes que estão competindo entre si
%O agente Max representa a perspectiva que está tentando aumentar as recompenças das suas ações.
%Já o agente Min é com quem o Max está jogando contra, e suas ações estão tentando ser minimizadas.
%Por exemplo, quando Min tem duas possibilidades de jogadas, uma boa e uma ruim, o algoritmo seleciona a ruim como melhor opção para Max, pois quanto menor a chance de Min ter uma jogada de sucesso, melhor para ele.

%Planejamento
\begin{frame}{Planejamento}
	
	\vspace{-3mm}
	\begin{figure}[here]
		\includegraphics[width=0.6\linewidth]{fig/modelo.pdf}	
	\end{figure}	
\end{frame}
%Planejamento estuda o processo de geração de planos de forma computacional.
%Para isso é preciso um planejador, ele tem com o objetivo encotnrar um plano que solucione um problema.
%O planejador utiliza uma representação do problema, que contém informações das ações disponiveis no ambiente. E apartir de um estado inicial, e um objetivo que se deseja alcaçar, o planejador encontra a sequencia de ações que parte do estado inicial e alcança seus objetivos. 

%Planejamento Hierárquico
\begin{frame}{Planejamento Hierárquico (HTN)}
	\begin{itemize}
		\item Tarefas alto nível
		\item Conhecimento de domínio
		\item Decomposições
	\end{itemize}
	\vspace{-3mm}
	\begin{figure}[here]
		\includegraphics[width=0.7\linewidth]{fig/htnmethodresult.pdf}	
	\end{figure}	
\end{frame}
%Problemas de grande complexidade acabam demorando muito com planejamento clássico.
%Como alternativa para isso, foi proposto o planejamento hierarquico, ou HTN.
%Ele se diferencia do anterior pelo fato de que as tarefas são tratadas em mais alto nivel, ou seja, as ações são decompostas em ações menores e assim por diante até que restem ações simples que possam ser realizadas no ambiente.
%Para isso, é preciso um conhecimento de domínio que contém informações relativas as ações disponiveis e transições que são feitas no ambiente.
%Por exemplo, para realizar uma viajem de carro, não é só pegar o carro e dirigir, é preciso ir ao mecanico, fazer as malas, colocar as malas no carro, e então viajar.

%Algoritmo de AHTN
\begin{frame}{Adversarial Hierarchical-Task Network}
	\begin{itemize}
		\item Como funciona o algoritmo?
		\item Minimax + planejamento hierárquico
	\end{itemize}
	
	\begin{figure}[here]
		\includegraphics[width=0.4\linewidth]{fig/ahtn.pdf}	
	\end{figure}	
\end{frame}
%O algoritmo de AHTN é uma combinação do algoritmo de Minimax com o conhecimento de domínio do planejamento hierarquico
%No AHTN os planos de cada um das perspectivas vão sendo decompostos.
%O algoritmo pode ir até uma determinada profundidade, ou decompor todo os espaço de estados
%A grande diferença do algoritmo é que a troca de perspectivas é feita apenas quando há uma tarefa primitiva a ser realizada no ambiente, caso o contrario o algoritmo decompoe as tarefas não primitivas e segue na mesma perspectiva

%MicroRTS+JSHOP2
{
	\setbeamercolor{background canvas}{bg=lightgray}
	\begin{frame}{Recursos Utilizados}
		\vspace{5mm}
		\begin{itemize}
			\item \textbf{MicroRTS}
			\item \textbf{JSHOP2}
		\end{itemize}
	\end{frame}
}
%MicroRTS
\begin{frame}{MicroRTS}
	\begin{itemize}
		\item O que é?
		\item Construções
		\item Unidades
		\item Técnicas
		\item Camada de abstração
	\end{itemize}
	\vspace{-3mm}
	\begin{figure}[here]
		\includegraphics[width=0.4\linewidth]{fig/microRTS.pdf}	
	\end{figure}	
\end{frame}
%JSHOP2
\begin{frame}{JSHOP2}
	\begin{itemize}
		\item Planejador
		\item Domínio
		\item Problema
	\end{itemize}
\end{frame}

{
	\setbeamercolor{background canvas}{bg=lightgray}
	\begin{frame}{Implementação}
		\vspace{5mm}
		\begin{itemize}
			\item \textbf{Ações do MicroRTS}
			\item \textbf{Modelagem do domínio}
			\item \textbf{Heurísticas}
			\item \textbf{Geração dos Planos}
			\item \textbf{Algoritmo AHTN}
		\end{itemize}
	\end{frame}
}

%Ações
\begin{frame}{Ações do MicroRTS}

	\begin{figure}[here]
		\includegraphics[width=1\linewidth]{fig/acoesmicro.png}	
	\end{figure}
\end{frame}
%Modelagem do Domínio
\begin{frame}{Modelagem do Domínio}
	\begin{itemize}
		\item Unidade de ataque
		\item Operadores
		\item Métodos
	\end{itemize}
\end{frame}
%Heurística
\begin{frame}{Heurística}
	\begin{itemize}
		\item Unidades adversárias
		\item Estado terminal
	\end{itemize}
	\vspace{5mm}
	\begin{equation}
	h(s) =  (1*worker) + (5 * quartel) + (10 * base) + (2 * unidadesDeAtaque)
	\end{equation}
\end{frame}
%Geração dos Planos
\begin{frame}{Geração dos Planos}
	\begin{figure}[here]
		\includegraphics[width=0.9\linewidth]{fig/gerarPlano.pdf}	
	\end{figure}	
\end{frame}
%Implementação
\begin{frame}{Algoritmo de AHTN}
	\vspace{5mm}
	{\footnotesize
	\begin{algorithmic}[1]		
		\Function {ATHNMax}{$estado, planoMax, planoMin, deph$}
		\If {$terminal(estado) \vee d \leq 0$} \label{alg:meuahtn:terminal}
		\State	\Return $(planoMax, planoMin, avaliacao(estado))$
		\EndIf
		\State {$nextAction(planoMax)$} \label{alg:meuahtn:nexaction}
		\State $(Pmax', Pmin', ev') = \perp, \perp, -\infty$
		\ForAll{$plano \in getPlanos(estado)$} \label{alg:meuahtn:for}
		\State $(Pmax, Pmin, ev) = \Call{AHTNMin}{(estado, planoMax, planoMin, deph-1)}$ \label{alg:meuahtn:ahtnmin}
		\If {$ev' > ev$} \label{alg:meuahtn:avali}
		\State $(Pmax', Pmin', ev') = (Pmax, Pmin, ev)$
		\EndIf		 		 		
		\EndFor
		\State \Return $(Pmax', Pmin', ev')$ \label{alg:meuahtn:retorno}
		\EndFunction
	\end{algorithmic}	
	}
\end{frame}

%Resultados
{
	\setbeamercolor{background canvas}{bg=lightgray}
	\begin{frame}{Resultados}
		\vspace{5mm}
		\begin{itemize}
			\item \textbf{Mapas}
			\item \textbf{Tamanho das técnicas}
			\item \textbf{Tempo de geração das ações}
		\end{itemize}
	\end{frame}
}
\begin{frame}{Mapas}
	\begin{itemize}
		\item Mapa 1
		\item Mapa 2
		\item Mapa 3
		\item Lados do jogo
	\end{itemize}
\end{frame}
%Mapa 1- 16x16, há diferença dos domínios, há técnica que não ganahva e agora ganha
%Mapa 2- 8x8 com quartel, principal diferença é no lado do jogo, o dominio não tem influencia porque já tem o quartel, e o jogo é rapido
%Mapa 3- 8x8 com obstaculo, parecido, o lado azul no domínio 2 ganha contra uma técnica que não ganhava antes.

%%Mapa 1
%\begin{frame}{Mapa 1}
%	
%	{\footnotesize
%	\begin{tabular}{|c|cc|cc|}
%		\hline
%		\textbf{}           & \multicolumn{2}{c|}{\textbf{Domínio 1}}  & \multicolumn{2}{c|}{\textbf{Domínio 2}}  \\ \hline
%		\textbf{Adversário} & \textbf{Lado Azul} & \textbf{Lado Vermelho} & \textbf{Lado Azul} & \textbf{Lado Vermelho} \\ \hline
%		RandomIA            & 100\%              & 100\%                  & 100\%              & 100\%                  \\ \hline
%		RandomBiasedIA      & 80\%               & 100\%                  & 100\%              & 100\%                  \\ \hline
%		RangedRush          & 0\%                & 100\%                  & 100\%              & 100\%                  \\ \hline
%		HeavyRush           & 0\%                & 100\%                  & 0\%                & 100\%                  \\ \hline
%		LightRush           & 0\%                & 100\%                  & 0\%                & 100\%                  \\ \hline
%		WorkerRush          & 0\%                & 0\%                    & 0\%                & 0\%                    \\ \hline
%		MonteCarlo          & 60\%               & 80\%                   & 100\%              & 100\%                  \\ \hline
%		Minimax             & 100\%              & 100\%                  & 100\%              & 100\%                  \\ \hline
%		Portfolio           & 0\%                & 0\%                    & 0\%                & 0\%                    \\ \hline
%	\end{tabular}
%	}
%\end{frame}
%%Mapa 2
%\begin{frame}{Mapa 2}
%	
%	{\footnotesize
%			\begin{tabular}{|c|cc|cc|}
%				\hline
%				\textbf{}           & \multicolumn{2}{c|}{\textbf{Domínio 1}}  & \multicolumn{2}{c|}{\textbf{Domínio 2}}  \\ \hline
%				\textbf{Adversário} & \textbf{Lado Azul} & \textbf{Lado Vermelho} & \textbf{Lado Azul} & \textbf{Lado Vermelho} \\ \hline
%				RandomIA            & 100\%              & 100\%                  & 100\%              & 100\%                  \\ \hline
%				RandomBiasedIA      & 40\%               & 80\%                   & 80\%               & 100\%                  \\ \hline
%				RangedRush          & 0\%                & 100\%                  & 0\%                & 100\%                  \\ \hline
%				HeavyRush           & 0\%                & 100\%                  & 0\%                & 100\%                  \\ \hline
%				LightRush           & 0\%                & 100\%                  & 0\%                & 100\%                  \\ \hline
%				WorkerRush          & 0\%                & 0\%                    & 0\%                & 0\%                    \\ \hline
%				MonteCarlo          & 0\%                & 0\%                    & 0\%                & 0\%                    \\ \hline
%				Minimax             & 0\%                & 100\%                  & 0\%                & 100\%                  \\ \hline
%				Portfolio           & 0\%                & 60\%                  & 0\%                & 80\%                  \\ \hline
%			\end{tabular}
%	}
%\end{frame}
%%Mapa 3
%\begin{frame}{Mapa 3}
%	
%	{\footnotesize
%			\begin{tabular}{|c|cc|cc|}
%				\hline
%				\textbf{}           & \multicolumn{2}{c|}{\textbf{Domínio 1}}  & \multicolumn{2}{c|}{\textbf{Domínio 2}}  \\ \hline
%				\textbf{Adversário} & \textbf{Lado Azul} & \textbf{Lado Vermelho} & \textbf{Lado Azul} & \textbf{Lado Vermelho} \\ \hline
%				RandomIA            & 100\%              & 100\%                  & 100\%              & 100\%                  \\ \hline
%				RandomBiasedIA      & 100\%              & 80\%                   & 100\%              & 80\%                   \\ \hline
%				RangedRush          & 0\%                & 100\%                  & 0\%                & 100\%                  \\ \hline
%				HeavyRush           & 0\%                & 100\%                  & 0\%                & 100\%                  \\ \hline
%				LightRush           & 0\%                & 100\%                  & 0\%                & 100\%                  \\ \hline
%				WorkerRush          & 0\%                & 0\%                    & 0\%                & 0\%                    \\ \hline
%				MonteCarlo          & 0\%                & 0\%                    & 0\%                & 0\%                    \\ \hline
%				Minimax             & 0\%                & 80\%                  & 80\%              & 80\%                   \\ \hline
%				Portfolio           & 0\%                & 0\%                    & 0\%                & 0\%                    \\ \hline
%			\end{tabular}
%	}
%\end{frame}
%Tamanho da IA
\begin{frame}{Tamanho das técnicas}
	\begin{itemize}
		\item Domínios HTN
		\item WorkerRush
		\item MonteCarlo
		\item Random
	\end{itemize}
\end{frame}
%Geração das ações
\begin{frame}{Tempo de geração das ações}
	\begin{figure}[here]
		\includegraphics[width=0.9\linewidth]{fig/graph.pdf}
	\end{figure}
\end{frame}

%Conclusao
\begin{frame}{Conclusão}
	\begin{itemize}
		\item Problemas
		\item Influência do domínio
		\item Trabalhos futuros
	\end{itemize}
\end{frame}

%	{
%		\setbeamercolor{background canvas}{bg=lightgray}
%		\begin{frame}{}
%			\centering
%			Obrigado!
%		\end{frame}
%	}  


\end{document}